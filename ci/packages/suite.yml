--- # suite package # --------------------------------

suite lint:
    stage: lint
    script:
        - yarn workspace @trezor/suite lint
    only:
        changes:
            - packages/suite/**/*
            - .gitlab-ci.yml

suite type check:
    stage: type check
    allow_failure: true
    script:
        - yarn workspace @trezor/suite type-check
    only:
        changes:
            - packages/suite/**/*
            - .gitlab-ci.yml

suite test unit:
    stage: test
    script:
        - env
        - yarn workspace @trezor/suite test:unit
    only:
        changes:
            - packages/suite/**/*
            - packages/suite-web/**/*
            - .gitlab-ci.yml

suite test integration:
    stage: test integration
    before_script:
        - apt-get update
        - apt-get install -y build-essential
        - apt-get install xvfb libgtk2.0-0 libnotify-dev libgconf-2-4 libnss3 libxss1 libasound2 --assume-yes
    script:
        - yarn workspace @trezor/suite test:health
    only:
        changes:
            - packages/suite/**/*
            - packages/suite-web/**/*
            - .gitlab-ci.yml
        refs:
            - master
            - develop
